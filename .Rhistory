y= "Soil layer border, cm")
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top", expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
scale_y_reverse(limits=c(32, 0))+
scale_y_continuous(breaks =seq(0, 32, -1))+
labs(
x= "PLOT",
y= "Soil layer border, cm")
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top", expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
scale_y_reverse(limits=c(32, 0))+
scale_y_continuous(breaks =seq(0, 32, 1))+
labs(
x= "PLOT",
y= "Soil layer border, cm")
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top", expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
scale_y_continuous(breaks =seq(0, 32, 1))+
scale_y_reverse(limits=c(32, 0))+
labs(
x= "PLOT",
y= "Soil layer border, cm")
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top", expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
scale_y_continuous(breaks =seq(0, -32, 1))+
scale_y_reverse(limits=c(32, 0))+
labs(
x= "PLOT",
y= "Soil layer border, cm")
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top", expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
# scale_y_continuous(breaks =seq(0, -32, 1))+
scale_y_reverse(limits=c(32, 0, 1))+
labs(
x= "PLOT",
y= "Soil layer border, cm")
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top", expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
scale_y_continuous(trans = "reverse", breaks =seq(0, 32, 1))+
#scale_y_reverse(limits=c(32, 0, 1))+
labs(
x= "PLOT",
y= "Soil layer border, cm")
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top", expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
scale_y_continuous(trans = "reverse", breaks =seq(0, -32, 1))+
#scale_y_reverse(limits=c(32, 0, 1))+
labs(
x= "PLOT",
y= "Soil layer border, cm")
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top", expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
scale_y_continuous(trans = "reverse", breaks =seq(0, 32, 1))+
#scale_y_reverse(limits=c(32, 0, 1))+
labs(
x= "PLOT",
y= "Soil layer border, cm")
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top", expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
scale_y_continuous(trans = "reverse", breaks =seq(0, 32, 1))+
#scale_y_reverse(limits=c(32, 0, 1))+
labs(
x= "PLOT",
y= "Soil layer border, cm")
ggsave("figures/lyrs_border.png", width = 8, height=4)
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top", expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
scale_y_continuous(trans = "reverse", breaks =seq(0, 32, 1))+
#scale_y_reverse(limits=c(32, 0, 1))+
labs(
x= "PLOT",
y= "Soil layer border, cm")
ggsave("figures/lyrs_border.png", width = 10, height=4)
View(narm)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
#summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not neede if filter in the beginning
pivot_wider(names_from = type, values_from = mxdpt)%>%
ggplot(aes(litter, soil))+
geom_point()
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
#summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not neede if filter in the beginning
pivot_wider(names_from = type, values_from = mxdpt)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
#summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not neede if filter in the beginning
pivot_wider(names_from = type, values_from = mxdpt)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
mutate(row = row_number()) %>%
#summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not neede if filter in the beginning
pivot_wider(names_from = type, values_from = mxdpt)%>%
select(-row)
cstock%>%
mutate(row = row_number())
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
mutate(row = row_number())
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
mutate(row = row_number(.x))
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top", expand = c(0, 0)) +
scale_y_continuous(trans = "reverse", breaks =seq(0, 32, 1))+
#scale_y_reverse(limits=c(32, 0, 1))+
labs(
x= "PLOT",
y= "Soil layer border, cm")
ggsave("figures/lyrs_border.png", width = 10, height=4)
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
ylim(0,range)+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top", expand = c(0, 0)) +
scale_y_continuous(trans = "reverse", breaks =seq(0, 32, 1))+
#scale_y_reverse(limits=c(32, 0, 1))+
labs(
x= "PLOT",
y= "Soil layer border, cm")
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top", expand = c(0, 0)) +
ylim(0,range)+
scale_y_continuous(trans = "reverse", breaks =seq(0, 32, 1))+
#scale_y_reverse(limits=c(32, 0, 1))+
labs(
x= "PLOT",
y= "Soil layer border, cm")
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top", expand = c(0, 0)) +
scale_y_continuous(limits=c(32, 0, 1), trans = "reverse", breaks =seq(0, 32, 1))+
#scale_y_reverse()+
labs(
x= "PLOT",
y= "Soil layer border, cm")
ggsave("figures/lyrs_border.png", width = 10, height=4)
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top") +
scale_y_continuous(limits=c(32, 0, 1), trans = "reverse", breaks =seq(0, 32, 1))+
#scale_y_reverse()+
labs(
x= "PLOT",
y= "Soil layer border, cm")
ggsave("figures/lyrs_border.png", width = 10, height=4)
cstock %>%
filter(!is.na(lbd))%>%
ggplot(aes(x=pl, y=lbd))+
geom_point(aes(colour = slyr), size = 2)+
scale_x_discrete(position = "top") +
scale_y_continuous(limits=c(32, 0), trans = "reverse", breaks =seq(0, 32, 1))+
#scale_y_reverse()+
labs(
x= "PLOT",
y= "Soil layer border, cm")
ggsave("figures/lyrs_border.png", width = 10, height=4)
cstock %>%
filter_all(any_vars(!is.na(.))) %>% #remove ROWS where ALL NAs
pivot_wider(
names_from = type, #names of new columns from factor 'type'
values_from = mxdpt, # values of new columns are from numeric variable "mxdpt"
names_glue = "{type}_mxdp")
library(xlsx)
library(readxl)
library(psych)
library(rstatix)
library(ggpubr)
library(ggplot2)
library(dplyr, warn=FALSE)
library(tidyr)
View(cstock)
#rename(New_Name = Old_Name)
cstock=cstock%>%
rename(tsf=tst)
cstock=cstock %>%
filter_all(any_vars(!is.na(.))) %>% #remove ROWS where ALL NAs
pivot_wider(
names_from = type, #names of new columns from factor 'type'
values_from = mxdpt, # values of new columns are from numeric variable "mxdpt"
names_glue = "{type}_mxdp")
cstock %>%
group_by(pl, slyr) %>%
summarise(across(everything(), mean)) %>%
```
cstock %>%
group_by(pl, slyr)
is.na(cstock$slyr)
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr)
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr) %>%
summarise(across(everything(), mean))
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr) %>%
summarise(cs=across(everything(), mean))
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr) %>%
summarise(cs=mean(cstock))
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr)
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr) %>%
summarize(cs=mean(cstock))
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(across(everything(), mean))
cstock%>%
filter(!is.na(slyr))%>%# remove all NAs prior analysis
#select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(across(everything(), mean))
cstock%>%
filter(!is.na(slyr))%>%# remove all NAs prior analysis
#select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, slyr)%>%#grouping by given factors
summarise(across(everything(), mean))
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr) %>%
dplyr::summarize(cs=mean(cstock$cstock))
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr) %>%
dplyr::summarize(cs=mean(cstock))
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr) %>%
dplyr::summarize(cs=mean(cstock),
cs_med=median(cstock))
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr) %>%
dplyr::summarize(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock)) %>% # создаём столбец мединан запасов по слоям
dplyr::mutate(cs_mn=sum(cs),
cs_mdn=sum(cs_med))
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr) %>%
dplyr::summarize(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock)) %>% # создаём столбец мединан запасов по слоям
dplyr::mutate(totcs_mn=sum(cs),
totcs_mdn=sum(cs_med))
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr)
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr) %>%
plyr::summarise(across(everything(), mean))
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr) %>%
dplyr::summarise(across(everything(), mean))
cstock<-cstock%>%
mutate(slyr = case_when(
lbd <= 5 ~ "top",
lbd <= 10 ~ "org10",
lbd > 10 & lbd <= 23 ~"min20",
lbd > 23 ~ "min30",
TRUE ~ "lit" # in all other cases = "other"
), .after = lyr)
cstock<-cstock%>%
mutate(slyr = case_when(
lbd <= 5 ~ "top",
lbd <= 10 ~ "org10",
lbd > 10 & lbd <= 23 ~"min20",
lbd > 23 ~ "min30",
TRUE ~ "lit" # in all other cases = "other"
), .after = lyr)  # mutate a new column after column $lyr
cstock$slyr<-as.factor(cstock$slyr)
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr) %>%
dplyr::summarise(across(everything(), mean))
cstock %>%
filter(!is.na(slyr)) %>%
group_by(pl, slyr) %>%
dplyr::summarise(across(everything(), mean),
cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock),# создаём столбец мединан запасов по слоям
totcs_mn=sum(cs), # общие запасы в почвах из средних
totcs_mdn=sum(cs_med))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(across(everything(), mean),
cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock),# создаём столбец мединан запасов по слоям
totcs_mn=sum(cs), # общие запасы в почвах из средних
totcs_mdn=sum(cs_med))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(across(everything(), median)
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(across(everything(), median()),
cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock),# создаём столбец мединан запасов по слоям
totcs_mn=sum(cs), # общие запасы в почвах из средних
totcs_mdn=sum(cs_med))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(across(everything(), mean),
cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock),# создаём столбец мединан запасов по слоям
totcs_mn=sum(cs), # общие запасы в почвах из средних
totcs_mdn=sum(cs_med))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock),# создаём столбец мединан запасов по слоям
totcs_mn=sum(cs), # общие запасы в почвах из средних
totcs_mdn=sum(cs_med),
across(everything(), mean))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock),# создаём столбец мединан запасов по слоям
across(everything(), mean)),
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock),# создаём столбец мединан запасов по слоям
across(everything(), mean))%>%
dplyr::mutate(totcs_mn=sum(cs), # общие запасы в почвах из средних
totcs_mdn=sum(cs_med))# общие запасы в почвах из медиан
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock),
.after = cstock)
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock), .after = lyr)
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock)%>%# создаём столбец мединан запасов по слоям
dplyr::mutate(totcs_mn=sum(cs), # общие запасы в почвах из средних
totcs_mdn=sum(cs_med))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock)%>%# создаём столбец мединан запасов по слоям
dplyr::mutate(totcs_mn=sum(cs),
totcs_mdn=sum(cs_med))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock)%>%# создаём столбец мединан запасов по слоям
dplyr::mutate(totcs_mn=sum(cs),
totcs_mdn=sum(cs_med))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock))%>%# создаём столбец мединан запасов по слоям
dplyr::mutate(totcs_mn=sum(cs),
totcs_mdn=sum(cs_med))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock))%>%# создаём столбец мединан запасов по слоям
dplyr::mutate(totcs_mn=sum(cs),
totcs_mdn=sum(cs_med))%>%
dplyr::summarise(across(everything(), mean))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock))%>%# создаём столбец мединан запасов по слоям
dplyr::mutate(totcs_mn=sum(cs),
totcs_mdn=sum(cs_med))%>%
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock))%>%# создаём столбец мединан запасов по слоям
dplyr::mutate(totcs_mn=sum(cs),
totcs_mdn=sum(cs_med))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock))%>%# создаём столбец мединан запасов по слоям
dplyr::mutate(totcs_mn=sum(cs),
totcs_mdn=sum(cs_med))
cstock %>%
group_by(pl, slyr)
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock), .groups = "drop")
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock), .groups = "drop")%>%# создаём столбец мединан запасов по слоям
dplyr::mutate(totcs_mn=sum(cs),# общие запасы в почвах из средних
totcs_mdn=sum(cs_med))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(cs=mean(cstock), # создаём столбец средних значений запасов по слоям
cs_med=median(cstock))%>%# создаём столбец мединан запасов по слоям
dplyr::mutate(totcs_mn=sum(cs),# общие запасы в почвах из средних
totcs_mdn=sum(cs_med))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(across(where(is.numeric) & !cstock, mean)),
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(across(where(is.numeric) & !cstock, mean))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(across(where(is.numeric) & !cstock, mean)),
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(across(where(is.numeric) & !cstock, mean),
cs=mean(cstock),
cs_med=median(cstock))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(across(where(is.numeric) & !cstock, mean),
cs=mean(cstock),
cs_med=median(cstock))%>%# создаём столбец мединан запасов по слоям
dplyr::mutate(totcs_mn=sum(cs),# общие запасы в почвах из средних
totcs_mdn=sum(cs_med))
cstock %>%
group_by(pl, slyr) %>%
dplyr::summarise(across(where(is.numeric) & !cstock, mean),# саммари по всем числовым столбцам кроме столбца с запасами С, он нужен далее
cs=mean(cstock),# создаём столбец средних значений запасов по слоям
cs_med=median(cstock))%>%# создаём столбец мединан запасов по слоям
dplyr::mutate(totcs_mn=sum(cs),# общие запасы в почвах из средних
totcs_mdn=sum(cs_med))# общие запасы в почвах из медиан
View(G_PCA)
View(cstock)
