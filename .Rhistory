ggplot(aes(colvars, fct_rev(rowvars))) +
geom_tile(colour="grey20", aes(fill=corr), size=0.5) +
#geom_point(aes(size=p.value, colour=cut(abs(corr), c(0, 0.01, 0.05, 1), include.lowest=TRUE)), pch=15) +
geom_text(aes(label=sprintf("%1.2f", corr)), position=position_nudge(y=0.2),
size=3, colour="black") +
geom_text(aes(label=paste0("(",sprintf("%1.2f", p.value),")")), position=position_nudge(y=-0.2),
size=2.5, colour="black") +
scale_fill_gradient2(low="red", mid="yellow2", high="blue", midpoint=0, limits=c(-1,1)) +
scale_size_continuous(range=c(7,12)) +
labs(x="",y="") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))#+
cssum %>%
select(where(is.numeric)) %>%
fa(nfactors=9,
rotate = "varimax",
fm="pa",
residuals = TRUE)
cssum %>%
select(where(is.numeric)) %>%
fa(nfactors=9,
rotate = "varimax",
#fm="pa",
residuals = TRUE)
cssum %>%
select(where(is.numeric)) %>%
fa(nfactors=9,
rotate = "oblimin",
#fm="pa",
residuals = TRUE)
cssum %>%
select(where(is.numeric)) %>%
fa(nfactors=9,
rotate = "oblimin",
fm="minres",
residuals = TRUE)
#residuals = TRUE)
cssum %>%
select(where(is.numeric)) %>%
fa(nfactors=9,
rotate = "oblimin",
fm="minres",
residuals = F)
cssum %>%
select(where(is.numeric)) %>%
fa(nfactors=9,
rotate = "oblimin",
fm="minres",
residuals = F) %>%
fa.diagram()
cssum %>%
select(where(is.numeric)) %>%
fa(nfactors=9,
rotate = "oblimin",
fm="ml",
fa="fa",
residuals = F)
cssum %>%
select(where(is.numeric)) %>%
fa(nfactors=9,
fm="ml",
fa="fa",
residuals = F)
cssum %>%
select(where(is.numeric)) %>%
fa.parallel(
fm="ml",
fa="fa"
)
cssum %>%
select(where(is.numeric)) %>%
fa.parallel(
fa="fa"
)
cssum %>%
select(where(is.numeric)) %>%
fa(nfactors=4,
rotate = "oblimin",
fm="ml",
residuals = F)
cssum %>%
select(where(is.numeric)) %>%
fa(nfactors=4,
rotate = "oblimin",
fm="gls",
residuals = F)
cssum %>%
select(where(is.numeric)) %>%
fa(nfactors=4,
rotate = "oblimin",
fm="gls",
residuals = F) %>%
fa.diagram()
cssum %>%
select(where(is.numeric)) %>%
fa(nfactors=4,
rotate = "oblimin",
fm="gls",
residuals = F) %>%
summary()
cssum %>%
select(where(is.numeric)) %>%
fa(nfactors=4,
rotate = "oblimin",
fm="gls",
residuals = F) %>%
print(
cut=.3,
digits = 2,
sort = TRUE
)
cssum %>%
select(where(is.numeric)) %>%
fa(nfactors=4,
rotate = "oblimin",
fm="gls",
residuals = F) %>%
fa.diagram()
install.packages("MVN")
mvn(cssum)
library(MVN)
mvn(cssum)
cstock %>%
select(where(is.numeric)) %>%
mvn()
cstock %>%
select(where(is.numeric)) %>%
na.omit() %>%
mvn()
cstock %>%
select(where(is.numeric)) %>%
na.omit()
cstock %>%
select(where(is.numeric))
View(narm1)
sumrf %>%
select(where(is.numeric)) %>%
mvn()
tic()
#Preparing dataset
library(sjPlot)
bstinsl=glmulti(Soil_c_stock ~ Litter_thikness + WD + Slope + Slope_facing + Fires_40yrs + MBS + litter_dpt + Soil_depth + Soil_10_20_C + Topsoil_C + Soil_20_30_C,
data=sumrf,
crit=aicc,
level=2,# 1 without, 2 - with interactions
method = "g", # g- is one of the possible models, see help
family=gaussian,
fitfunction = glm,
confsetsize = 20)
library(glmulti)
bstinsl=glmulti(Soil_c_stock ~ Litter_thikness + WD + Slope + Slope_facing + Fires_40yrs + MBS + litter_dpt + Soil_depth + Soil_10_20_C + Topsoil_C + Soil_20_30_C,
data=sumrf,
crit=aicc,
level=2,# 1 without, 2 - with interactions
method = "g", # g- is one of the possible models, see help
family=gaussian,
fitfunction = glm,
confsetsize = 20)
library(tictoc)
tic()
bstsl=glmulti(Soil_c_stock ~ .,
data=sumrf[, 2:26],
crit=aicc,
level=1,# 1 without, 2 - with interactions
method = "g", # g- is one of the possible models, see help
family=gaussian,
fitfunction = glm,
confsetsize = 20)
toc()
print(bstsl)
plot(bstsl)
library(flextable)# library for table nicer looking
weightable(bstsl)[1:4,] %>%
regulartable() %>%
autofit()
tab_model(gl30, gl3,
collapse.ci = TRUE,
p.style = "numeric_stars")
library(rpart)
library(partykit)
library(ggplot2)
library(ggparty)
library(rpart.plot)
Soiltree<-rpart(Soil_c_stock ~ Litter_thikness + WD + Slope + Slope_facing + Fires_40yrs + MBS + litter_dpt + Soil_depth, data=sumrf)
Soiltree$variable.importance#
printcp(Soiltree)
plotcp(Soiltree)
plot(as.party(Soiltree),tp_args = list(id=FALSE))
plot_models(gl30, vline.color = "red")
check_model(gl30)
abline(v=5, lwd=3, lty=2)# линия отсекающая ненужные предикторы
gl3=glm(Soil_c_stock ~ ., family = Gamma, data=sumrf[, 2:26])
summary(gl3)
VIFgl3=vif(gl3) # vif() form library(car)
par(mar=c(3.1, 8, 3.1, 2.1)) #for bottom, left, top, right.
barplot(VIFgl3, main= "VIF values", horiz = TRUE, col = "burlywood3", las=1, cex.names=.7)+
abline(v=5, lwd=3, lty=2)
View(sumrf)
library(xlsx)
library(readxl)
sumrf %>%
write.xlsx(as.data.frame,file='cstock.xlsx')
library(dplyr)
sumrf %>%
write.xlsx(as.data.frame,file='cstock.xlsx')
cstock %>%
select(where(is.numeric))%>%
tbl_summary(statistic = list(all_continuous() ~ "{mean} ({min}-{max})"))
library(xlsx)
library(readxl)
library(psych)
library(rstatix)
library(ggpubr)
library(ggplot2)
library(dplyr, warn=FALSE)
library(tidyr)
library(purrr)
library(gtsummary)
library(hrbrthemes)
library(viridis)
library(data.table)
library(broom)
library(rpart)
library(partykit)
library(ggparty)
library(rpart.plot)
library(performance)
library(report)
library(naniar)
cstock %>%
select(where(is.numeric))%>%
tbl_summary(statistic = list(all_continuous() ~ "{mean} ({min}-{max})"))
dplyr::summarise()
cstock %>%
select(where(is.numeric))%>%
group_by(pl)
cstock %>%
group_by(pl)
select(where(is.numeric))%>%
tbl_summary(statistic = list(all_continuous() ~ "{mean} ({min}-{max})"))
cstock %>%
group_by(pl) %>%
select(where(is.numeric))%>%
tbl_summary(statistic = list(all_continuous() ~ "{mean} ({min}-{max})"))
library(MVN)
cstock %>%
dplyr::filter(slyr == "lit") %>%
dplyr::select(pl, lstock, cstock) %>%
mvn()
cstock %>%
dplyr::filter(slyr == "lit")
cstock %>%
dplyr::filter(slyr == "lit") %>%
dplyr::select(pl, lstock, cstock)
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
mvn()
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock)
library(MVN)
sumrf %>%
select(where(is.numeric)) %>%
mvn()
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
group_by(pl) %>%
dplyr::select(lstock, cstock) %>%
mvn()
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
group_by(pl) %>%
dplyr::select(lstock, cstock)
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
group_by(pl)
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
group_by(pl) %>%
dplyr::select(lstock, cstock) %>%
mvn()
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
group_by(pl) %>%
dplyr::select(lstock, cstock) %>%
tbl_strata(strata = pl,
~.x %>%
tbl_summary()
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
group_by(pl) %>%
dplyr::select(lstock, cstock) %>%
tbl_strata(strata = pl,
~.x)
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
group_by(pl) %>%
dplyr::select(pl, lstock, cstock) %>%
tbl_strata(strata = pl,
~.x)
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
group_by(pl) %>%
dplyr::select(pl, lstock, cstock) %>%
tbl_strata(strata = pl,
~.x) %>%
tbl_summary(missing = "no",
statistic = list(all_continuous()~"{median}\u00b1{se}"),
digits=list(all_continuous() ~c(1, 2)))
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
group_by(pl) %>%
dplyr::select(pl, lstock, cstock) %>%
tbl_strata(strata = pl) %>%
tbl_summary(missing = "no",
statistic = list(all_continuous()~"{median}\u00b1{se}"),
digits=list(all_continuous() ~c(1, 2)))
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
group_by(pl) %>%
dplyr::select(pl, lstock, cstock) %>%
tbl_strata(strata = pl, ~.x) %>%
tbl_summary(missing = "no",
statistic = list(all_continuous()~"{median}\u00b1{se}"),
digits=list(all_continuous() ~c(1, 2)))
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
group_by(pl) %>%
dplyr::select(pl, lstock, cstock) %>%
summarise()
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl) %>%
summarise()
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl) %>%
summarise()
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl) %>%
dplyr::summarise(across(where(is.numeric)
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl)
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl) %>%
#dplyr::summarise(across(where(is.numeric)
summarise_each(funs(mean(., na.rm = TRUE)))
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl) %>%
describe()
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl) %>%
describeBy(group = pl)
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl) %>%
describeBy(pl)
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
describeBy(pl)
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
describe_by(pl)
litter=cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock)
describeBy(litter, litter$pl)
group_by(pl) %>%
summarise(across(everything(), list(mean)))
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl) %>%
summarise(across(everything(), list(mean)))
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl) %>%
summarise(across(everything(), list(mean, sd)))
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl) %>%
summarise(across(everything(), list(mean, sd, min, max)))
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl) %>%
summarise(across(everything(), list(mean, sd, min, max)))
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl) %>%
describe()
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl) %>%
describe(across(everything()))
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl) %>%
summarise, list(mean, sd, min, max) %>%
cstock %>%
dplyr::filter(slyr == "lit",
!is.na(pl))  %>%
dplyr::select(pl, lstock, cstock) %>%
group_by(pl) %>%
summarise(across(everything(), list(mean, sd, min, max))) %>%
write.xlsx(as.data.frame,file='csum.xlsx')
sumrf%>%
select(where(is.numeric)) %>% # выбираем все числовые
melt() %>%# переводим в длинный формат таблицы было 42 строки и 26 колонок, стало 1050 строк и 2 колонки
ggplot(aes(x=value))+
stat_density()+# тип графика плотность распределния
facet_wrap(~variable, scales = "free")#
library(xlsx)
library(readxl)
library(psych)
library(rstatix)
library(ggpubr)
library(ggplot2)
library(dplyr, warn=FALSE)
library(tidyr)
library(purrr)
library(gtsummary)
library(hrbrthemes)
library(viridis)
library(data.table)
library(broom)
library(rpart)
library(partykit)
library(ggparty)
library(rpart.plot)
library(performance)
library(report)
library(naniar)
sumrf%>%
select(where(is.numeric)) %>% # выбираем все числовые
melt() %>%# переводим в длинный формат таблицы было 42 строки и 26 колонок, стало 1050 строк и 2 колонки
ggplot(aes(x=value))+
stat_density()+# тип графика плотность распределния
facet_wrap(~variable, scales = "free")#
sumrf%>%
select(where(is.numeric)) %>% # выбираем все числовые
melt() %>%# переводим в длинный формат таблицы было 42 строки и 26 колонок, стало 1050 строк и 2 колонки
ggplot(aes(x=value))+
stat_density()+# тип графика плотность распределния
facet_wrap(~variable, scales = "free")
ggsave("figures/dstrbn.png", width = 10, height=4)#
sumrf%>%
select(where(is.numeric)) %>% # выбираем все числовые
melt() %>%# переводим в длинный формат таблицы было 42 строки и 26 колонок, стало 1050 строк и 2 колонки
ggplot(aes(x=value))+
stat_density()+# тип графика плотность распределния
facet_wrap(~variable, scales = "free")+
ggsave("figures/dstrbn.png", width = 10, height=4)#
sumrf%>%
select(where(is.numeric)) %>% # выбираем все числовые
melt() %>%# переводим в длинный формат таблицы было 42 строки и 26 колонок, стало 1050 строк и 2 колонки
ggplot(aes(x=value))+
stat_density()+# тип графика плотность распределния
facet_wrap(~variable, scales = "free")
ggsave("figures/dstrbn.png", width = 10, height=8)#
