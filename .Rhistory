library(ggpubr)
library(cowplot)
library(gmt)
library(geosphere)
library(rlang)
library(ggplot2)
library(nlme)
library(lme4)
library(gridExtra)
library(GGally)
library(devtools)
install_github("vqv/ggbiplot")
library(ggbiplot)
library(reshape2)
library(PMCMR)
library(RVAideMemoire)
library(MuMIn)
library(visreg)
set.seed(123)
n <- 895
cst <- data.frame(
ID = seq(n),
plot = factor(sample(paste0("D", 1:42), n, replace = TRUE)),
type = factor(sample(c("litter", "soil"), n, replace = TRUE)),
mxdpt = runif(n, 5, 7)
)
cst %>%
group_by(plot, type) %>%
summarise(mxdpt = mean(mxdpt, na.rm = TRUE)) %>%
pivot_wider(names_from = type, values_from = mxdpt) %>%
ggplot(aes(litter, soil)) +
geom_point()
knitr::opts_chunk$set(echo = TRUE)
cstock%>%
filter_at(vars(mxdpt), all_vars(!is.na(.)))
library(dplyr)
library(ggplot2)
cstock%>%
filter(vars(mxdpt), all_vars(!is.na(.)))%>%
select_(pl, type, mxdpt)%>%#select a given columns
group_by_(pl, type)
install.packages(c("cachem", "data.table", "dtplyr", "gh", "httr", "RcppArmadillo", "tidyverse", "xts"))
library(plyr)
remove.packages("plyr")
remove.packages("dplyr")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
install.packages("dplyr")
library(tidyverse)
cstock%>%
filter(vars(mxdpt), all_vars(!is.na(.)))%>%
select(pl, type, mxdpt)%>%#select a given columns
group_by(pl, type)
library(dplyr)
library(ggplot2)
cstock%>%
filter(vars(mxdpt), all_vars(!is.na(.)))%>%
select(pl, type, mxdpt)
cstock%>%
filter(vars(mxdpt), all_vars(!is.na(.)))%>%
select(pl, type, mxdpt)
detach("package:dplyr", unload = TRUE)
library(dplyr)
library(xlsx)
library(readxl)
library(psych)
library(dplyr)
library(factoextra)
library(FactoMineR)
library(ade4)
library(car)
library(corrplot)
library(graphics)
library(pvclust)
library(doBy)
library(ggpubr)
library(scales)
require(ggthemes)
require(ggpmisc)
library(beanplot)
library(multcomp)
require(multcomp)
library(lubridate)
library(MASS)
library(TraMineR)
library(vegan)
library(tidyverse)
library(rstatix)
library(ggpubr)
library(cowplot)
library(gmt)
library(geosphere)
library(rlang)
library(ggplot2)
library(nlme)
library(lme4)
library(gridExtra)
library(GGally)
#pivot_wider creates columns of same row number with values from given column and names of new column by factor's level
cstock%>%
filter(vars(mxdpt), all_vars(!is.na(.)))%>%
select(pl, type, mxdpt)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))%>%
pivot_wider(names_from = type, values_from = mxdpt, values_fn = list)ggplot(aes(litter, soil))+
cstock%>%
filter(vars(mxdpt), all_vars(!is.na(.)))%>%
select(pl, type, mxdpt)
cstock%>%
filter(vars(mxdpt), all_vars(!is.na(.)))
set.seed(123)
n <- 895
cst <- data.frame(
ID = seq(n),
plot = factor(sample(paste0("D", 1:42), n, replace = TRUE)),
type = factor(sample(c("litter", "soil"), n, replace = TRUE)),
mxdpt = runif(n, 5, 7)
)
cst %>%
group_by(plot, type) %>%
summarise(mxdpt = mean(mxdpt, na.rm = TRUE)) %>%
pivot_wider(names_from = type, values_from = mxdpt) %>%
ggplot(aes(litter, soil)) +
geom_point()
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr, warn=FALSE)
library(tidyr)
cstock%>%
filter(vars(mxdpt), all_vars(!is.na(.)))
library(ggplot2)
library(dplyr, warn=FALSE)
library(tidyr)
cstock%>%
filter(vars(mxdpt), all_vars(!is.na(.)))%>%
select(pl, type, mxdpt)
cstock%>%
filter_(vars(mxdpt), all_vars(!is.na(.)))
library(tidyr)
cstock%>%
filter(vars(mxdpt), all_vars(!is.na(.)))
rm(md, mds)
rm(n)
rm(cst)
cstock%>%
#filter(vars(mxdpt), all_vars(!is.na(.)))%>%
select(pl, type, mxdpt)
cstock%>%
filter(vars(mxdpt), all_vars(!is.na(.)))%>%
select(pl, type, mxdpt)
cstock%>%
filter(mxdpt, all_vars(!is.na(.))
cstock%>%
library(abind)
detach("package:abind", unload = TRUE)
.libPaths()
~/.config/rstudio
config/rstudio
library(abind)
library(ade4)
library(askpass)
detach("package:askpass", unload = TRUE)
detach("package:ade4", unload = TRUE)
detach("package:abind", unload = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr, warn=FALSE)
library(tidyr)
library(xlsx)
library(readxl)
workbook<- "D:/R/CSTOCK1/data/CSTOCK.xlsx"
cstock<-read.xlsx(workbook, 1, colClasses="character")# colClasses all characters to retrieve correct data without losing and replacing by NAs.
#names(cstock)
#cstock<-read.xlsx(workbook, 1,colClasses=c("integer","integer", "integer","numeric", "integer", "numeric"))
#str(cstock)
##transform data from 'chr' to proper format: 'num', 'int'
#cstock$ID<-as.vector(cstock$ID)# as 'ID' has a 'Y-1' format reformatting it to a factor returns NA, leave as is
cstock$pl<-as.factor(cstock$pl)
cstock$type<-as.factor(cstock$type)
cstock$mxdpt<-as.numeric(cstock$mxdpt)
cstock$lyr<-as.integer(cstock$lyr)
cstock$lthkn<-as.numeric(cstock$lthkn)
cstock$lstock<-as.numeric(cstock$lstock)
cstock$e<-as.numeric(cstock$e)
cstock$n<-as.numeric(cstock$n)
cstock$TPG<-as.factor(cstock$TPG)
cstock$sl<-as.numeric(cstock$sl)
#pivot_wider creates columns of same row number with values from given column and names of new column by factor's level
is.na.data.frame(cstock)
library(ggplot2)
library(dplyr, warn=FALSE)
library(tidyr)
cstock%>%
filter(vars(mxdpt), all_vars(!is.na(.)))
cstock%>%
#filter(vars(mxdpt), all_vars(!is.na(.)))%>%
select(pl, type, mxdpt)
cstock%>%
#filter(vars(mxdpt), all_vars(!is.na(.)))%>%
select(pl, type, mxdpt)%>%#select a given columns
group_by(pl, type)
cstock%>%
#filter(vars(mxdpt), all_vars(!is.na(.)))%>%
select(pl, type, mxdpt)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))
cstock%>%
#filter(vars(mxdpt), all_vars(!is.na(.)))%>%
select(pl, type, mxdpt)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))%>%
pivot_wider(names_from = type, values_from = mxdpt)%>%
ggplot(aes(litter, soil))+
geom_point()
cstock%>%
#filter(vars(mxdpt), all_vars(!is.na(.)))%>%
select(pl, type, mxdpt)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))
cstock%>%
filter(!is.na(mxdpt))%>%
select(pl, type, mxdpt)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not needed if filter exist
pivot_wider(names_from = type, values_from = mxdpt)%>%
ggplot(aes(litter, soil))+
geom_point()
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not needed if filter exist
pivot_wider(names_from = type, values_from = mxdpt)%>%
ggplot(aes(litter, soil))+
geom_point()+
geom_smooth(se=FALSE, aes(color="2"), size=0.5, span=0.15, show.legend = F)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not needed if filter exist
pivot_wider(names_from = type, values_from = mxdpt)%>%
ggplot(aes(litter, soil))+
geom_point()+
geom_smooth(se=FALSE, aes(color="2"), linewidth=0.5, span=0.15, show.legend = F)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not needed if filter exist
pivot_wider(names_from = type, values_from = mxdpt)%>%
ggplot(aes(litter, soil))+
geom_point()+
geom_smooth(se=FALSE, aes(color="2"), linewidth=0.5, span=0.5, show.legend = F)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not needed if filter exist
pivot_wider(names_from = type, values_from = mxdpt)%>%
ggplot(aes(litter, soil))+
geom_point()+
geom_smooth(se=FALSE, aes(color="2"), linewidth=0.5, span=0.5, show.legend = F)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e)%>%#select a given columns
group_by(pl, type)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e)%>%#select a given columns
group_by(e, type)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e)%>%#select a given columns
group_by(e, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e)%>%#select a given columns
group_by(e, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not needed if filter exist
pivot_wider(names_from = type, values_from = mxdpt)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e)%>%#select a given columns
group_by(e, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not needed if filter exist
pivot_wider(names_from = type, values_from = mxdpt)%>%
ggplot(aes(litter, soil))+
geom_point()+
geom_smooth(se=FALSE, aes(color="2"), linewidth=0.5, span=0.5, show.legend = F)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e)%>%#select a given columns
group_by(e, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not needed if filter exist
pivot_wider(names_from = type, values_from = mxdpt)%>%
ggplot(aes(litter, e))+
geom_point()+
geom_smooth(se=FALSE, aes(color="2"), linewidth=0.5, span=0.5, show.legend = F)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e)%>%#select a given columns
group_by(e, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not needed if filter exist
pivot_wider(names_from = type, values_from = mxdpt)%>%
ggplot(aes(e, litter))+
geom_point()+
geom_smooth(se=FALSE, aes(color="2"), linewidth=0.5, span=0.5, show.legend = F)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e)%>%#select a given columns
group_by(e, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not needed if filter exist
pivot_wider(names_from = type, values_from = mxdpt)%>%
ggplot(aes(e, litter))+
geom_point()+
geom_smooth(se=FALSE, aes(color="2"), linewidth=0.5, span=0.8, show.legend = F)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not neede if filter in the beginning
pivot_wider(names_from = type, values_from = mxdpt)%>%
ggplot(aes(litter, soil))+
geom_point()
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))%>%#na.rm is not neede if filter in the beginning
pivot_wider(names_from = type, values_from = mxdpt)%>%
ggplot(aes(litter, soil))+
geom_point()
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(type)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(plot, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(mxdpt=mean(mxdpt, na.rm=T))
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(across(everything(), mean))
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(across(everything(), mean))%>%# все переменные в саммари)
pivot_wider(names_from = type, values_from = mxdpt)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(across(everything(), mean))%>%# все переменные в саммари)
pivot_wider(names_from = type, values_from = mxdpt, values_fn = list )# колонки из переменной по фактору
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(across(everything(), mean))%>%# все переменные в саммари)
pivot_wider(names_from = type, values_from = mxdpt, values_fn = NULL )# колонки из переменной по фактору
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(across(everything(), mean))%>%# все переменные в саммари)
pivot_wider(names_from = type, values_from = mxdpt, values_fn = 0 )# колонки из переменной по фактору
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(across(everything(), mean))%>%# все переменные в саммари)
pivot_wider(names_from = type, values_from = mxdpt)# колонки из переменной по фактору
gen=cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(across(everything(), mean))%>%# все переменные в саммари)
pivot_wider(names_from = type, values_from = mxdpt)# колонки из переменной по фактору
View(gen)
cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(across(everything(), mean))%>%# все переменные в саммари)
pivot_wider(names_from = type, values_from = mxdpt)
gen=cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(across(everything(), mean))%>%# все переменные в саммари)
pivot_wider(names_from = type, values_from = mxdpt)%>%
# колонки из переменной по фактору
View(gen)
gen=cstock%>%
filter(!is.na(mxdpt))%>%# remove all NAs prior analysis
select(pl, type, mxdpt, e, n)%>%#select a given columns
group_by(pl, type)%>%#grouping by given factors
summarise(across(everything(), mean))%>%# все переменные в саммари)
pivot_wider(names_from = type, values_from = mxdpt) # колонки из переменной по фактору
gen%>%
ggplot(aes(litter, soil))+
geom_point()
gen%>%
ggplot(aes(litter, soil), aes(fill=type))+
geom_point()
gen%>%
ggplot(aes(litter, soil))+
geom_point(fill='white', color=type, size=3, shape=21,)
gen%>%
ggplot(aes(litter, soil))+
geom_point(fill='white', color="brown", size=3, shape=21,)
gen%>%
ggplot(aes(litter, soil, fill=type))+
geom_point(fill='white', color="brown", size=3, shape=21,)
gen%>%
ggplot(aes(litter, soil, fill=type))+
geom_point(fill='white', color=c("brown", "yellow"), size=3, shape=21,)
gen%>%
ggplot(aes(litter, soil, color=type))+
geom_point(fill='white', color=c("brown", "yellow"), size=3, shape=21,)
gen%>%
ggplot(aes(litter, soil, color=type))+
geom_point(size=3, shape=21,)
gen%>%
ggplot(aes(litter, soil, color="type"))+
geom_point(size=3, shape=21,)
gen%>%
ggplot(aes(litter, soil, color="type"))+
geom_point(size=3, shape=12,)
gen%>%
ggplot(aes(litter, soil, color="type"))+
geom_point(size=3, shape=10,)
gen%>%
ggplot(aes(litter, soil, color="type"))+
geom_point(size=3, shape=2,)
gen%>%
ggplot(aes(litter, soil))+
geom_point(size=3, shape=2,)
gen%>%
ggplot(aes(litter, soil))+
geom_point(fill="green", color="blue", size=3, shape=2,)
gen%>%
ggplot(aes(litter, soil))+
geom_point(fill="green", color="blue", size=3, shape=1)
gen%>%
ggplot(aes(mxdpt, e, color=type))+
geom_point(size=3, shape=1)
gen%>%
ggplot(aes(litter, e, color=type))+
geom_point(size=3, shape=1)
gen%>%
ggplot(aes(litter, e, color=pl))+
geom_point(size=3, shape=1)
gen%>%
ggplot(aes(e, litter, color=pl))+
geom_point(size=3, shape=1)
gen%>%
ggplot(aes(e, litter, color=pl))+
geom_point()
gen%>%
ggplot(aes(e, litter, color=pl))+
geom_point()+
stat_smooth(method=lm, se=F, color="red")
gen%>%
ggplot(aes(n, litter, color=pl))+
geom_point()+
stat_smooth(method=lm, se=F, color="red")
gen%>%
ggplot(aes(n, litter, color=pl))+
geom_point()+
stat_smooth(method=glm, se=F, color="red")
gen%>%
ggplot(aes(n, litter, color=pl))+
geom_point()+
stat_smooth(method=loess, se=F, color="red")
