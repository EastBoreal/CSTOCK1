library(geosphere)
library(rlang)
library(plyr)
library(ggplot2)
library(nlme)
library(lme4)
library(gridExtra)
library(GGally)
library(devtools)
install_github("vqv/ggbiplot")
library(ggbiplot)
library(reshape2)
library(PMCMR)
library(RVAideMemoire)
library(MuMIn)
library(visreg)
knitr::opts_chunk$set(echo = TRUE)
library(xlsx)
library(readxl)
library(psych)
library(dplyr)
library(ggplot2)
library(factoextra)
library(FactoMineR)
library(ade4)
library(car)
library(corrplot)
library(graphics)
library(pvclust)
library(doBy)
library(ggpubr)
library(scales)
require(ggthemes)
require(ggpmisc)
library(beanplot)
library(multcomp)
require(multcomp)
library(lubridate)
library(MASS)
library(TraMineR)
library(vegan)
library(tidyverse)
library(rstatix)
library(ggpubr)
library(cowplot)
library(gmt)
library(geosphere)
library(rlang)
library(plyr)
library(ggplot2)
library(nlme)
library(lme4)
library(gridExtra)
library(GGally)
library(devtools)
install_github("vqv/ggbiplot")
library(ggbiplot)
library(reshape2)
library(PMCMR)
library(RVAideMemoire)
library(MuMIn)
library(visreg)
workbook<- "D:\R\CSTOCK\data\CSTOCK.xlsx"
workbook<- "D:/R/CSTOCK/data/CSTOCK.xlsx"
cstock<-read.xlsx(workbook, 1)
str(cstock)
cstock%>%
#filter(day !="0"& day !="218")%>%
group_by(plot)%>%
#identify_outliers(rem)
get_summary_stats(mxdpt, type="mean_se")
str(cstock)
cstock[sapply(cstock, is.character)] <- lapply(cstock[sapply(cstock, is.character)], as.factor)# transform all characters to factors
str(cstock)
cstock<-read.xlsx(workbook, 1)
str(cstock)
View(cstock)
cstock$ID<-as.integer(cstock$ID)
cstock$mxdpt<-as.integer(cstock$mxdpt)
cstock$mxdpt<-as.numeric(cstock$mxdpt)
cstock$lyr<-as.integer(cstock$lyr)
View(cstock)
cstock<-read.xlsx(workbook, 1, colClasses="character")
cstock<-read.xlsx(workbook, 1,colClasses=c("ID"="integer","plot"="factor"))
cstock<-read.xlsx(workbook, 1,colClasses=c("ID"="integer","plot"="numeric"))
cstock<-read.xlsx(workbook, 1,colClasses=c("ID"="integer","mxdpth"="numeric"))
cstock<-read.xlsx(workbook, 1,colClasses=c("ID"="integer","mxdpth"="numeric"))
cstock<-read.xlsx(workbook, 1,colClasses=c("ID"="integer","mxdpt"="numeric"))
cstock<-read.xlsx(workbook, 1,colClasses=c("ID"="integer","lyr"="integer"))
cstock<-read.xlsx(workbook, 1,colClasses=c("integer","numeric"))
cstock<-read.xlsx(workbook, 1,colClasses=c("int","numeric"))
cstock<-read.xlsx(workbook, 1,colClasses=c("integer","integer", "integer","numeric"))
cstock<-read.xlsx(workbook, 1,colClasses=c("integer","integer", "integer","numeric", "integer", "numeric"))
cstock$plot<-as.factor(cstock$plot)
cstock<-read.xlsx(workbook, 1,colClasses=c("integer","integer", "integer","numeric", "integer", "numeric"))
cstock<-read.xlsx(workbook, 1, colClasses="character")# colClasses
names(cstock)
##transform data from 'chr' to proper format: 'num', 'int'
cstock$ID<-as.integer(cstock$ID)
cstock$plot<-as.factor(cstock$plot)
cstock$type<-as.factor(cstock$type)
cstock$mxdpt<-as.numeric(cstock$mxdpt)
cstock$lyr<-as.integer(cstock$lyr)
names(cstock)
cstock$e<-as.numeric(cstock$e)
cstock$n<-as.numeric(cstock$n)
cstock$lthkn<-as.numeric(cstock$lthkn)
cstock$lstock<-as.numeric(cstock$lstock)
View(cstock)
knitr::opts_chunk$set(echo = TRUE)
library(xlsx)
library(readxl)
library(psych)
library(dplyr)
library(ggplot2)
library(factoextra)
library(FactoMineR)
library(ade4)
library(car)
library(corrplot)
library(graphics)
library(pvclust)
library(doBy)
library(ggpubr)
library(scales)
require(ggthemes)
require(ggpmisc)
library(beanplot)
library(multcomp)
require(multcomp)
library(lubridate)
library(MASS)
library(TraMineR)
library(vegan)
library(tidyverse)
library(rstatix)
library(ggpubr)
library(cowplot)
library(gmt)
library(geosphere)
library(rlang)
library(plyr)
library(ggplot2)
library(nlme)
library(lme4)
library(gridExtra)
library(GGally)
library(devtools)
install_github("vqv/ggbiplot")
library(ggbiplot)
library(reshape2)
library(PMCMR)
library(RVAideMemoire)
library(MuMIn)
library(visreg)
cstock$TPG<-as.factor(cstock$TPG)
cstock$sl<-as.numeric(cstock$sl)
cstock%>%
#filter(day !="0"& day !="218")%>%
group_by(plot)%>%
#identify_outliers(rem)
get_summary_stats(mxdpt, type="mean_se")
View(cstock)
cstock%>%
#filter(day !="0"& day !="218")%>%
group_by(plot, type)%>%
#identify_outliers(rem)
get_summary_stats(mxdpt, type="mean_se")
cstock%>%
#filter(day !="0"& day !="218")%>%
group_by(plot, type)%>%
#identify_outliers(rem)
ggplot(aes(x=mxdpt, y=mxdpt, color=type, group= type))+stat_summary(fun = mean, geom = 'point', pch=15)+stat_summary(fun = mean, geom ='line')+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.1)#+scale_x_discrete(labels=c("март", "май", "июнь", "июль", "август", "сентябрь", "октябрь"))+labs( x="Дата", y="Эмиссия, г С м-2 сут-1")+guides(color=guide_legend(title="")) +theme_classic()
plot1
cstock%>%
group_by(plot)%>%
mutate(soildepth= mxdpt(filter(type==soil)))
cstock%>%
group_by(plot)%>%
mutate(soildepth= filter(mxdpt, type==soil))
cstock%>%
group_by(plot)%>%
mutate(soildepth= mxdpt)
cstock%>%
group_by(plot)%>%
mutate(soildepth= mean(mxdpt))
cstock%>%
group_by(plot)%>%
mutate(soildepth= mean(mxdpt))%>%
m=cstock%>%
group_by(plot)%>%
mutate(soildepth= mean(mxdpt))%>%
m=cstock%>%
group_by(plot)%>%
mutate(soildepth= mean(mxdpt))
cstock%>%
group_by(plot)%>%
mutate(soildepth= mean(mxdpt))
cstock%>%
group_by(plot)%>%
mutate(soildepth= filter(mxdpt, type=="soil"))
cstock%>%
group_by(plot)%>%
mutate(soildepth= filter(mxdpt, type=='soil'))
arrange(cstock, plot)
arrange(cstock, plot, type)
cstock%>%
group_by(plot)%>%
filter(mxdpt, type=="soil"))
cstock%>%
group_by(plot)%>%
filter(mxdpt, type=="soil")
cstock$plot<-as.integer(cstock$plot)
cstock%>%
group_by(plot)%>%
filter(mxdpt, type=="soil")
cstock$plot<-as.logical(cstock$plot)
cstock$plot<-as.ineteger(cstock$plot)
cstock<-read.xlsx(workbook, 1, colClasses="character")# colClasses all characters to retrieve correct data without losing and replacing by NAs.
##transform data from 'chr' to proper format: 'num', 'int'
cstock$ID<-as.integer(cstock$ID)
cstock<-read.xlsx(workbook, 1, colClasses="character")# colClasses all characters to retrieve correct data without losing and replacing by NAs.
cstock%>%
group_by(plot)%>%
filter(mxdpt, type=="soil")
##transform data from 'chr' to proper format: 'num', 'int'
cstock$ID<-as.vector(cstock$ID)
cstock%>%
group_by(plot)%>%
filter(mxdpt, type=="soil")
cstock$plot<-as.vector(cstock$plot)
arrange(cstock, plot, type)
cstock%>%
group_by(plot)%>%
filter(mxdpt, type=="soil")
cstock$type<-as.vector(cstock$type)
arrange(cstock, plot, type)
cstock%>%
group_by(plot)%>%
filter(mxdpt, type=="soil")
arrange(cstock, plot, type)
cstock%>%
select(cstock, plot, mxdpt, type)
group_by(plot)%>%
filter(mxdpt, type=="soil")
arrange(cstock, plot, type)
cstock%>%
select(cstock, plot, mxdpt, type)
group_by(plot)%>%
filter(mxdpt, type=="soil")
cstock%>%
select(cstock, plot, mxdpt, type)
cstock%>%
select(plot, mxdpt, type)
arrange(cstock, plot, type)
cstock%>%
select(plot, mxdpt, type)%>%
group_by(plot)%>%
filter(mxdpt, type=="soil")
rename(cstock, plot = plt)
cstock%>%
group_by(plot)%>%
select(plot, mxdpt, type)%>%
rename(cstock, plot = plt)
cstock%>%
group_by(plot)%>%
select(plot, mxdpt, type)
cstock%>%
group_by(plot)%>%
select(plot, mxdpt, type)
cstock%>%
group_by(plot)%>%
select(plot, mxdpt, type)%>%
soilmx=mean(mxdpt, na.rm=TRUE)
cstock$mxdpt<-as.numeric(cstock$mxdpt)
cstock%>%
group_by(plot)%>%
select(plot, mxdpt, type)%>%
soilmx=mean(mxdpt, na.rm=TRUE)
cstock%>%
group_by(plot)%>%
select(plot, mxdpt, type)%>%
mutate(soilmx=mean(mxdpt, na.rm=TRUE))
cstock%>%
group_by(plot)%>%
select(plot, mxdpt, type)%>%
mutate(soilmx=mean(mxdpt, plot, na.rm=TRUE))
cstock%>%
group_by(plot)%>%
select(plot, mxdpt, type)%>%
group_by(type)%>%
mutate(soilmx=mean(mxdpt, na.rm=TRUE))
cstock%>%
group_by(plot)%>%
select(plot, mxdpt, type)
cstock$plot<-as.factor(cstock$plot)
cstock$type<-as.factor(cstock$type)
#cstock<-read.xlsx(workbook, 1,colClasses=c("integer","integer", "integer","numeric", "integer", "numeric"))
str(cstock)
ggplot(aes(x=mxdpt, y=mxdpt, color=type, group= type))+stat_summary(fun = mean, geom = 'point', pch=15)
cstock%>%
ggplot(aes(x=mxdpt, y=mxdpt, color=type, group= type))+stat_summary(fun = mean, geom = 'point', pch=15)
cstock%>%
ggplot(aes(x=mxdpt, y=mxdpt, color=type))+stat_summary(fun = mean, geom = 'point', pch=15)+stat_summary(fun = mean, geom ='line')+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.1)
cstock$lthkn<-as.numeric(cstock$lthkn)
cstock$TPG<-as.factor(cstock$TPG)
cstock$e<-as.numeric(cstock$e)
cstock$n<-as.numeric(cstock$n)
#identify_outliers(rem)
cstock%>%
ggplot(aes(x=mxdpt, y=lthkn, color=type))+stat_summary(fun = mean, geom = 'point', pch=15)+stat_summary(fun = mean, geom ='line')+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.1)#
#identify_outliers(rem)
cstock%>%
ggplot(aes(x=mxdpt, y=lthkn, group_by(plot)))+stat_summary(fun = mean, geom = 'point', pch=15)+stat_summary(fun = mean, geom ='line')+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.1)#
cstock<-read.xlsx(workbook, 1, colClasses="character")# colClasses all characters to retrieve correct data without losing and replacing by NAs.
cstock$plot<-as.factor(cstock$plot)
cstock$type<-as.factor(cstock$type)
cstock$mxdpt<-as.numeric(cstock$mxdpt)
cstock$lyr<-as.integer(cstock$lyr)
cstock$lthkn<-as.numeric(cstock$lthkn)
cstock$lstock<-as.numeric(cstock$lstock)
cstock$e<-as.numeric(cstock$e)
cstock$n<-as.numeric(cstock$n)
cstock$TPG<-as.factor(cstock$TPG)
cstock$sl<-as.numeric(cstock$sl)
mdp<-cstock%>%
#filter(day !="0"& day !="218")%>%
group_by(plot, type)
View(mdp)
mdp<-cstock%>%
group_by(plot)%>%
select(plot, mxdpt, type)
View(mdp)
View(mdp)
mdp<-cstock%>%
select(plot, mxdpt, type)
mdp<-cstock%>%
select(plot, mxdpt, type)%>%
group_by(type, plot)%>%
mutate(soilmx=mean(mxdpt, na.rm=T,
littermx=mean(mxdpt, na.rm=T)
)
mdp<-cstock%>%
mdp<-cstock%>%
select(plot, mxdpt, type)%>%
group_by(type, plot)%>%
mutate(soilmx=mean(mxdpt, na.rm=T,
littermx=mean(mxdpt, na.rm=T)
mdp<-cstock%>%
mdp<-cstock%>%
select(plot, mxdpt, type)%>%
#group_by(type, plot)%>%
mutate(soilmx=mean(mxdpt, na.rm=T,
littermx=mean(mxdpt, na.rm=T)
View(mdp)
md<-cstock%>%
group_by(type, plot)%>%
select(plot, mxdpt, type)%>%
summarise(mean(mxdpt))
summarise(mean(mxdpt))
cstock%>%
group_by(type, plot)%>%
select(plot, mxdpt, type)%>%
summarise(mean(mxdpt))
cstock%>%
group_by(type, plot)%>%
select(plot, mxdpt, type)%>%
summarise(mean= mean(mxdpt))
View(md)
View(md)
View(mdp)
md<-cstock%>%
group_by(type, plot)%>%
#select(plot, mxdpt, type)%>%
summarise(mean= mean(mxdpt))
View(md)
cstock%>%
group_by(type, plot)
cstock%>%
group_by(type, plot)%>%
#select(plot, mxdpt, type)%>%
summarise(mean= mean(mxdpt))
md=cstock%>%
group_by(type, plot)%>%
#select(plot, mxdpt, type)%>%
summarise(md, mean= mean(mxdpt))
View(md)
md=cstock%>%
group_by(type, plot)%>%
#select(plot, mxdpt, type)%>%
summarise(md, nmean= mean(mxdpt))
View(md)
md=cstock%>%
group_by(plot)%>%
#select(plot, mxdpt, type)%>%
summarise(md, nmean= mean(mxdpt))
View(md)
md=cstock%>%
#group_by(plot)%>%
select(plot, mxdpt, type)
md%>%
group_by(plot)%>%
summarise(md, nmean= mean(mxdpt))
md%>%
group_by(plot)
View(md)
rm(mdp)
md%>%
group_by(plot)%>%
mutate(smx= if_else(type=="soil",
mean(mxdpt),
smx=NA))
md%>%
group_by(plot)%>%
mutate(smx= if_else(type=="soil",
mean(mxdpt),
NA,
NA))
View(md)
View(md)
md%>%
group_by(plot)%>%
mutate(smx= ifelse(type=="soil",
mean(mxdpt),
NA,
NA))
md%>%
group_by(plot)%>%
mutate(smx= ifelse(type=="soil",mean(mxdpt),NA))
md%>%
#group_by(plot)%>%
mutate(smx= ifelse(type=="soil",mean(mxdpt),NA))
View(md)
mds<-md%>%
filter(type=="soil")
View(mds)
md%>%
filter(type=="soil")
md%>%
mutate(smx=filter(type=="soil"))
md%>%
filter(type=="soil")%>%
mutate(smx=mean(mxdpt))
md%>%
group_by(plot)%>%
filter(type=="soil")%>%
mutate(smx=mean(mxdpt))
md%>%
group_by(plot)%>%
filter(type=="soil")%>%
mutate(smx=mean(mxdpt)),
md%>%
group_by(plot)%>%
filter(type=="soil")%>%
ggplot(aes(x=plot, y=mxdpt))+stat_summary(fun = mean, geom = 'bar', aes(fill= plot), colour='black', width = 0.5, position= position_dodge(0.6))+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.3,position= position_dodge(0.6),aes(fill= pl))
md%>%
group_by(plot)%>%
filter(type=="soil")%>%
ggplot(aes(x=plot, y=mxdpt))+stat_summary(fun = mean, geom = 'bar', aes(fill= plot), colour='black', width = 0.5, position= position_dodge(0.6))+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.3,position= position_dodge(0.6),aes(fill= plot))
md%>%
group_by(plot)%>%
filter(type=="soil")%>%
ggplot(aes(x=plot, y=mxdpt))+stat_summary(fun = mean, geom = 'bar', aes(fill= plot), colour='black', width = 0.5, position= position_dodge(0.6))+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.3,position= position_dodge(0.6))
md%>%
arrange(plot)%>%
group_by(plot)%>%
filter(type=="soil")%>%
ggplot(aes(x=plot, y=mxdpt))+stat_summary(fun = mean, geom = 'bar', aes(fill= plot), colour='black', width = 0.5, position= position_dodge(0.6))+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.3,position= position_dodge(0.6))
md%>%
arrange(factor(plot)%>%
group_by(plot)%>%
filter(type=="soil")%>%
ggplot(aes(x=plot, y=mxdpt))+stat_summary(fun = mean, geom = 'bar', aes(fill= plot), colour='black', width = 0.5, position= position_dodge(0.6))+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.3,position= position_dodge(0.6))
md%>%
md%>%
arrange(factor(plot))%>%
group_by(plot)%>%
filter(type=="soil")%>%
ggplot(aes(x=plot, y=mxdpt))+stat_summary(fun = mean, geom = 'bar', aes(fill= plot), colour='black', width = 0.5, position= position_dodge(0.6))+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.3,position= position_dodge(0.6))
md%>%
arrange(factor(plot))%>%
group_by(plot)%>%
filter(type=="soil")%>%
ggplot(aes(x=plot, y=mxdpt))+stat_summary(fun = mean, geom = 'bar', aes(fill= plot), colour='black', width = 0.3, position= position_dodge(0.6))+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.3,position= position_dodge(0.6))
cstock%>%
filter(type=="litter")%>%
ggplot(aes(x=mxdpt, y=fn40))+stat_summary(fun = mean, geom = 'point', pch=15)+stat_summary(fun = mean, geom ='line')+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.1)
cstock%>%
filter(type=="litter")%>%
ggplot(aes(x=fn40, y=mxdpt))+stat_summary(fun = mean, geom = 'point', pch=15)+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.1)
cstock%>%
filter(type=="litter")%>%
ggplot(aes(x=fn40, y=mxdpt, group_by(plot)))+stat_summary(fun = mean, geom = 'point', pch=15)+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.1)
cstock%>%
filter(type=="litter")%>%
ggplot(aes(x=fn40, y=mxdpt ))+stat_summary(fun = mean, geom = 'point', group_by(plot), pch=15)+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.1)
cstock%>%
filter(type=="litter")%>%
ggplot(aes(x=fn40, y=mxdpt ))+stat_summary(fun = mean, group_by(plot), geom = 'point',  pch=15)+stat_summary(fun.data = mean_se, geom="errorbar", width= 0.1)
cstock%>%
filter(type=="litter")%>%
ggplot(aes(x=fn40, y=mxdpt, group_by(plot, geom=point))
cstock%>%
cstock%>%
filter(type=="litter")%>%
ggplot(aes(x=fn40, y=mxdpt, group_by(plot, geom=point)))
cstock%>%
filter(type=="litter")%>%
ggplot(aes(x=fn40, y=mxdpt, group_by(plot), geom=point))
cstock%>%
filter(type=="litter")%>%
ggplot(aes(x=fn40, y=mxdpt, group_by(plot), geom_point()))
